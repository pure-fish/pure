dist: trusty

jobs:
  include:
    - stage: build-images 
      name: "Build docker images"
      language: c
      before_script:
        - docker pull ohmyfish/fish:2.4.0
        - docker pull ohmyfish/fish:2.5.0
        - docker pull ohmyfish/fish:2.6.0
        - docker pull ohmyfish/fish:2.7.1
        - docker pull ohmyfish/fish:3.0.0
      script:
        - make build-supported-versions

    - stage: test
      name: "Test on Fish-2.4.0"
      script:
        - make test-on FISH_VERSION=2.4.0"

    - stage: test
      name: "Test on Fish-2.5.0"
      script:
        - make test-on FISH_VERSION=2.5.0"

    - stage: test
      name: "Test on Fish-2.6.0"
      script:
        - make test-on FISH_VERSION=2.6.0"

    - stage: test
      name: "Test on Fish-2.7.1"
      script:
        - make test-on FISH_VERSION=2.7.1"

    - stage: test
      name: "Test on Fish-3.0.0"
      script:
        - make test-on FISH_VERSION=3.0.0"

notifications:
  email: false
